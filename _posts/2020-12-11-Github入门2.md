---
title: Githubå…¥é—¨2 - åº•å±‚çš„3ç§å¯¹è±¡ä¸3ä¸ªåŒºåŸŸ
author: Jasper Fang
date: 2020-12-11 16:27:00 +0800
categories: [Github]
tags: [github]
pin: false
---

## Gitçš„ä¸¤æ¡å­¦ä¹ è·¯çº¿

* **ä¸‰ä¸ªå¯¹è±¡ï¼Œä¸‰ä¸ªåŒºåŸŸ**ï¼Œä¸‰ä¸ªçŠ¶æ€ã€‚
  
  * 3 Objects:                   `Blob` => `Tree` => `Commit`
* 3 Areas: 
    * `Working Directory ` => `Stage Index ` =>        `History `
    * â€‹      `æœ¬åœ°å·¥ä½œåŒº`              =>       `æš‚å­˜åŒº`        => `ç‰ˆæœ¬åº“\å†å²è®°å½•åŒº`
  * 3 Status: 
    * â€‹                     `modified `ï¼Œ`staged `ï¼Œ`committed `
    * â€‹                          å·²ä¿®æ”¹ï¼Œ   å·²æš‚å­˜ï¼Œ     å·²æäº¤
  
* é¢å¤–å†…å®¹ï¼š

  * .git ç›®å½•ç»“æ„

    * hooks: 
    * info: 
    * logs: 
    * **objects**: 
    * refs: 
    * COMMIT_EDITMSG: 
    * config: 
    * description: 
    * FETCH_HEAD: 
    * HEAD: 
    * **index**: 

    

## Git ä¸‰å¤§å¯¹è±¡ï¼š

* blob å¯¹è±¡ 

  * æ ¸å¿ƒï¼šå°±æ˜¯ä¸ª **hash-object** çš„ **k-v** é”®å€¼å¯¹æ•°æ®åº“

  * ä»£è¡¨ï¼š **å•æ–‡ä»¶çš„ä¸€ä¸ªç‰ˆæœ¬ï¼ŒåŠå†…å®¹**   

  * å­˜æ”¾ï¼šfileçš„hashï¼ˆä½œä¸ºæ•°æ®åº“çš„keyï¼‰ï¼Œå­˜å‹ç¼©çš„å†…å®¹ï¼ˆä½œä¸ºæ•°æ®åº“çš„valueï¼‰   

  * ä½œç”¨åŒºåŸŸï¼š`æœ¬åœ°å·¥ä½œåŒº`

  * ç¼ºé™·ï¼š
    * åªæœ‰blobå¯¹è±¡çš„è¯ï¼Œä»…é€šè¿‡å®ƒä»¬æ— æ³•çŸ¥é“é¡¹ç›®æ€»ä½“è½®å»“(æ–‡ä»¶é—´å…³è”) ï¼ˆ`å¼•å‡º tree å¯¹è±¡`ï¼‰
    * åªé€šè¿‡hashæ¥ç¡®å®škeyï¼Œæ•°æ®ä¸è¶³ï¼Œæ— æ³•ç¡®å®šç‰ˆæœ¬çš„å…ˆåé¡ºåº ï¼ˆ`å¼•å‡º commit å¯¹è±¡`ï¼‰

  * æŒ‡ä»¤æ§åˆ¶ï¼š

    * **åœ¨å·¥ä½œåŒºï¼ˆä¸”åœ¨objectsç›®å½•ä¸­ï¼‰åˆ›å»ºblobå¯¹è±¡**ï¼š ***(-w)***  
      `$ echo "test content v1" > ./file.txt`  
      `$ git hash-object -w ./file.txt`  

    * é€šè¿‡linuxç®¡é“(pipeline)æŒ‡ä»¤ï¼Œåœ¨å·¥ä½œåŒºç›´æ¥åˆ›å»ºblobå¯¹è±¡ï¼ˆä¸å¸¸ç”¨ï¼‰ï¼š  
      `$ echo 'test content' | git hash-object -w --stdin`  
      (--stdin = STarDand INput from command)  
    * ä»…æŸ¥çœ‹å¯¹è±¡ hash (SHA1) å€¼ï¼š  
      `$ git hash-object ./file.txt`  

  * è¡¥å……ï¼š
    * **(!)** ç‰¹æ€§ï¼šblobå¯¹è±¡ä¸åƒSVNé‚£æ ·å­˜å·®å¼‚æˆ–å¢é‡æ•°æ®ï¼Œè€Œæ˜¯å‹ç¼©åå­˜å‚¨å…¨éƒ¨æ•°æ®ã€‚æ¯æ¬¡æ–°å¢ä¸€ä¸ªhashï¼Œæ•°æ®åº“éƒ½ä¼šå¢å¤§ã€‚
    * **(!)** è‡ªå·±ä¿®æ”¹å®Œæ–‡ä»¶ï¼Œè‹¥ä¸è¾“å…¥ `$ git hash-object -w ./file.txt`ï¼Œ Gitæ˜¯ä¸ä¼šçŸ¥é“ä½ ç‰ˆæœ¬æœ‰æ›´æ–°çš„ã€‚å½“ç„¶ï¼Œè¿™ä¸ªåŠŸèƒ½è¢«  `$ git add ./file.txt` å°è£…äº†ï¼Œä½†å®ƒè¿˜åŒ…å«äº†å…¶ä»–åŠŸèƒ½ï¼Œåç»­è¯´æ˜ [Link]ã€‚

    * **(x)** è‹¥æƒ³æŸ¥çœ‹hash-objectä¸­çš„valueï¼Œåœ¨linuxå‘½ä»¤ä¸­è°ƒç”¨catæŒ‡ä»¤ï¼Œå¦‚ï¼š

      `$ cat ./.git/objects/d6/5490dsn2ud3b2uf87f2b`

      â€‹      è¯¥æŒ‡ä»¤åªèƒ½çœ‹åˆ°è¢«å‹ç¼©åçš„value (åŠ å¯†æ–‡ä»¶å†…å®¹) 

    * **(âˆš)** æ‰€ä»¥è‹¥æƒ³**æŸ¥çœ‹**è§£å‹åï¼ˆè§£ç åï¼‰çš„**object content**ï¼Œéœ€è¦ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š

      `$ git cat-file -p d65490dsn2ud3b2uf87f2b` 

    * **(âˆš)** è‹¥æƒ³**æŸ¥çœ‹**ä¸€ä¸ªobjectçš„**ç±»å‹** ï¼ˆæ˜¯blobï¼Œtreeï¼Œè¿˜æ˜¯commitç±»ï¼‰ï¼Œåˆ™ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š

      `$ git cat-file -t d65490dsn2ud3b2uf87f2b` 

      â€‹    *ï¼ˆå…¶ä¸­hashå€¼å¹¶ä¸éœ€è¦å†™å…¨éƒ¨ï¼Œä¹Ÿå¯ä»¥åŒ¹é…åˆ°ï¼‰*

* tree å¯¹è±¡

  * æ ¸å¿ƒï¼šç”¨**æŒ‡é’ˆ**æ¥å…³è”å„ä¸ªç›¸å…³objects (blobs, or sub-trees) çš„key (SHA-1 hash)ï¼Œä»è€Œæ„å»ºä¸€ä¸ªç‰ˆæœ¬çš„è½®å»“

  * ä»£è¡¨ï¼š  **è¯¥é¡¹ç›®çš„ä¸€ä¸ªç‰ˆæœ¬**   ä¹Ÿå°±æ˜¯**é¡¹ç›®çš„è½®å»“ï¼Œæˆ–å¿«ç…§**

  * å­˜æ”¾ï¼šå­˜treeçš„hashï¼Œå­˜fileçš„index    

  * ä½œç”¨åŒºåŸŸï¼š`æš‚å­˜åŒº`

  * ç¼ºé™·ï¼šä»…å­˜ä¸‹äº†é¡¹ç›®è½®å»“åŠæ–‡ä»¶å…³ç³»ï¼Œå•ä¸çŸ¥æ˜¯è°ï¼Œä»€ä¹ˆæ—¶å€™ï¼Œå› ä¸ºä»€ä¹ˆï¼Œç§çš„æ ‘ï¼ˆ`å¼•å‡º commit å¯¹è±¡`ï¼‰

  * è¡¥å……ï¼š

    * tree å¯¹è±¡å¯ä»¥æŒ‡å‘ï¼ˆå«æœ‰ï¼‰å¦ä¸€ä¸ªtreeå¯¹è±¡ï¼ˆsub-treeï¼‰ï¼Œæˆ–è€…è¯´å¦ä¸€ä¸ªç›®å½•ã€‚

  * æŒ‡ä»¤æ§åˆ¶ï¼š

    * **æŸ¥çœ‹æš‚å­˜åŒºçŠ¶æ€**

      `$ git ls-files -s`   **"s"** stands for "**S**tage Index" Area

    * **æ›´æ–°æš‚å­˜åŒºæ•°æ®**

      `$ git update-index --add --cacheinfo 100644 560a3d89bf36ea10794402f6664740c284d4ae3b ./test.txt `

      å…¶ä¸­ï¼š

      * 100644 = æ™®é€šæ–‡ä»¶ç±»å‹
      * 100755 = å¯æ‰§è¡Œæ–‡ä»¶
      * 120000 = ç¬¦å·é“¾æ¥ 

      æ­¤å¤–ï¼Œtreeä¸åŒäºblobåœ¨å·¥ä½œåŒºçš„æŒç»­æ·»åŠ ï¼Œæš‚å­˜åŒºçš„å†…å®¹è‹¥å·²å­˜åœ¨åˆ™ç›´æ¥è¦†å†™ï¼Œå¦‚ï¼š

      `$ git update-index --add --cacheinfo 100644 e1d551f2a5c0d06def7edde8ffe66c6e06f8ca6d ./test.txt `

      å®ƒåªä¼šæ›´æ”¹ä¸Šè¿°ä¸­åŒä¸€æ¡text.txtè®°å½•çš„hashå€¼ã€‚

    * **å°†æš‚å­˜åŒºå†…å®¹å†™ä¸ºä¸€ä¸ª Tree å¯¹è±¡**

      `$ git write-tree`

      *ï¼ˆä¸”å­˜å…¥ objects ç›®å½•ä¸­ï¼Œå¹¶è¿”å› tree å¯¹è±¡çš„ hashï¼‰*

    * **æŸ¥çœ‹ Tree å¯¹è±¡å†…å®¹**

      `$ git cat-file -p 5f5087577ca62d5dbed59ffcaf5f4ad7bd5e1b3e`

    * **è¯»å–ä¸€ä¸ª sub-tree åˆ°æš‚å­˜åŒº**

      `$ git read-tree 5f5087577ca62d5dbed59ffcaf5f4ad7bd5e1b3e`

      *ï¼ˆä»hash keyè¯»å–ä¸€ä¸ª treeï¼‰*

* commit å¯¹è±¡

  * ä»£è¡¨ï¼š **å¯¹ tree è¿›è¡Œå°è£…ï¼Œ åŠ å…¥å‡ æ¡é¢å¤–æè¿°ä¿¡æ¯è€Œå·²**  
  
  * å­˜æ”¾ï¼šè°ï¼Œä»€ä¹ˆæ—¶å€™ï¼Œå› ä¸ºä»€ä¹ˆï¼Œæ˜¯ç¬¬å‡ æ¬¡ï¼Œç§äº†å“ªä¸ªæ ‘
  
  * æŒ‡ä»¤æ§åˆ¶ï¼š
  
    * **åˆæ¬¡åˆ›å»ºæäº¤å¯¹è±¡**
  
      `$ git commit-tree 5f50875 -m "first commit"`
  
      æˆ–
  
      `$ echo "first commit" | git commit-tree 5f50875 `
  
      *ï¼ˆå®ƒä¹Ÿä¼šå­˜å…¥ objects ç›®å½•ä¸­ï¼Œå¹¶è¿”å› commitå¯¹è±¡çš„ hashï¼‰*
  
    * **éåˆæ¬¡åˆ›å»ºæäº¤å¯¹è±¡**  [ éœ€æŒ‡å®šçˆ¶çº§commitå¯¹è±¡ (**-p**) ]
  
      `$ git commit-tree 5f50875 -m "new commit" -p 77ca62d5d`
  
    * **æŸ¥çœ‹ commit å¯¹è±¡å†…å®¹**
  
      `$ git cat-file -p d592d5dbed59ffcaf5f4ad7bd5effcafe`
  
      *ï¼ˆä¸€èˆ¬æ˜¯ä¸€ä¸ª tree çš„ hash å¸¦ä¸Š ä½œè€…ä¿¡æ¯ï¼‰*



## Gité¢å¤–ç¬”è®°

* Project snapshot is a Tree

* File is a Blob from Tree

* Blob is a "key-value"  or "hash-object" data

* Commit is an encapsulated Tree with author information

* Tree can have sub-tree

  

* "ls" stands for "List"

* "cd" stands for "Change Directory"

  

## Gitæ¢è¡Œæ ¼å¼  

* LF:  Line Feed (Windows é»˜è®¤æ¢è¡Œæœºåˆ¶)
  * LFæ ·ä¾‹ï¼š    **\n**  
* CRLF: Carriage Return Line Feed åŒ…å«å›è½¦çš„æ¢è¡Œæœºåˆ¶ ï¼ˆlinux & git é»˜è®¤æ¢è¡Œæœºåˆ¶ï¼‰  
  * CRLFæ ·ä¾‹ï¼š   **\r\n**  



 ![image1](/assets/img/postimage/1.jpg "image1")  
 ![image2](/assets/img/postimage/2.jpg "image2")  
 ![image3](/assets/img/postimage/3.jpg "image3")  
 ![image4](/assets/img/postimage/4.jpg "image4")  
 ![image5](/assets/img/postimage/5.jpg "image5")  
 ![image6](/assets/img/postimage/6.jpg "image6")  
 ![image7](/assets/img/postimage/7.jpg "image7")  
 ![image8](/assets/img/postimage/8.jpg "image8")  
 ![image9](/assets/img/postimage/9.jpg "image9")  


### emoji test: 

ğŸ¨âš¡ï¸ğŸ”¥ğŸ›ğŸš‘âœ¨ğŸ“ğŸš€ğŸ‰ğŸ’„âœ…ğŸ”’ğŸ”–ğŸ”§ğŸš¨ğŸš§ğŸ’šâ¬‡ï¸â¬†ï¸ğŸ“Œ
ğŸ“ŒğŸ‘·ğŸ“ˆâ™»ï¸â•â–ğŸ”¨ğŸŒâœï¸ğŸ’©âªğŸ”€ğŸ“¦ğŸ‘½ğŸššğŸ“„ğŸ’¥
ğŸ±â™¿ï¸ğŸ’¡ğŸ»ğŸ’¬ğŸ—ƒğŸ”ŠğŸ”‡ğŸ‘¥ğŸš¸ğŸ—ğŸ“±ğŸ¤¡ğŸ¥šğŸ™ˆğŸ“¸âš—ğŸ”ğŸ·ï¸ğŸŒ±
ğŸš©ğŸ¥…ğŸ’«ğŸ—‘ğŸ›‚ğŸ©¹ğŸ§ 